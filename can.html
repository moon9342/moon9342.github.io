<!DOCTYPE html>
<html>
<head>

    <!-- Document Settings -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <!-- Base Meta -->
    <!-- dynamically fixing the title for tag/author pages -->



    <title>CAN Protocol</title>
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />


    <!-- jQuery + Fitvids, which makes all video embeds responsive -->
    <script
            src="https://code.jquery.com/jquery-3.2.1.min.js"
            integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
            crossorigin="anonymous">
    </script>

    <!-- 웹 폰트 설정 -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/earlyaccess/nanumgothic.css">

    <!-- Font Awesome CDN 설정 => 느림.. -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

    <!-- custom.css -->
    <link rel="stylesheet" href="/assets/built/custom.css">

    <!-- syntax.css -->
    <link rel="stylesheet" href="/assets/built/syntax.css">

    <!-- gist.css -->
    <link rel="stylesheet" href="/assets/built/better-gist-styles.css">

    <!-- Styles'n'Scripts -->
    <link rel="stylesheet" type="text/css" href="/assets/built/screen.css" />
    <link rel="stylesheet" type="text/css" href="/assets/built/screen.edited.css" />

    <!-- highlight.js -->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/styles/default.min.css">
    <style>.hljs { background: none; }</style>

    <!--Dl Menu-->
    <script src="/assets/js/modernizr.custom.js"></script>
    <script src="/assets/js/jquery.dlmenu.js"></script>
    <script src="/assets/js/menu_main.js"></script>

    <!-- Google AdSense -->
    <script data-ad-client="ca-pub-2687024418565562" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

    <!-- This tag outputs SEO meta+structured data and other important settings -->
    <meta name="description" content="얼큰우동TV, 쉽게배우는 IT(Programming,Machine Learning,금융)" />
    <link rel="shortcut icon" href="http://localhost:4000/assets/built/images/favicon.jpg" type="image/png" />
    <link rel="canonical" href="http://localhost:4000/can" />
    <meta name="referrer" content="no-referrer-when-downgrade" />

     <!--title below is coming from _includes/dynamic_title-->
    <meta property="og:site_name" content="IT Technical Training" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="CAN Protocol" />
    <meta property="og:description" content="CAN 개요 CAN은 Controller Area Network의 약자로 1986년에 독일의 메르세데스 벤츠사의 요구 (자동차내의 3개의 서로다른 ECU간의 데이터 통신)로 자동차 부품회사인 로베르트 보쉬사가 개발해 자동차기술자 협회에서 제안한 네트워크 시스템입니다. ECU는 Electoric Control Unit의 약자로 자동차의 엔진, 자동변속기, ABS등의 상태를 컴퓨터로 제어하는 전자제어장치를 의미합니다. 이런 ECU들은 각 목적에 따라 차량안에 분산되어 위치하고" />
    <meta property="og:url" content="http://localhost:4000/can" />
    <meta property="og:image" content="http://localhost:4000/assets/built/images/iot-logo.png" />
    <meta property="article:publisher" content="https://www.facebook.com/" />
    <meta property="article:author" content="https://www.facebook.com/" />
    <meta property="article:published_time" content="2020-02-17T01:40:00+09:00" />
    <meta property="article:modified_time" content="2020-02-17T01:40:00+09:00" />
    <meta property="article:tag" content="Et-cetera" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="CAN Protocol" />
    <meta name="twitter:description" content="CAN 개요 CAN은 Controller Area Network의 약자로 1986년에 독일의 메르세데스 벤츠사의 요구 (자동차내의 3개의 서로다른 ECU간의 데이터 통신)로 자동차 부품회사인 로베르트 보쉬사가 개발해 자동차기술자 협회에서 제안한 네트워크 시스템입니다. ECU는 Electoric Control Unit의 약자로 자동차의 엔진, 자동변속기, ABS등의 상태를 컴퓨터로 제어하는 전자제어장치를 의미합니다. 이런 ECU들은 각 목적에 따라 차량안에 분산되어 위치하고" />
    <meta name="twitter:url" content="http://localhost:4000/" />
    <meta name="twitter:image" content="http://localhost:4000/assets/built/images/iot-logo.png" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="IT Technical Training" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="Et-cetera" />
    <meta name="twitter:site" content="@" />
    <meta name="twitter:creator" content="@" />
    <meta property="og:image:width" content="1400" />
    <meta property="og:image:height" content="933" />

    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Website",
    "publisher": {
        "@type": "Organization",
        "name": "IT Technical Training",
        "logo": "http://localhost:4000/"
    },
    "url": "http://localhost:4000/can",
    "image": {
        "@type": "ImageObject",
        "url": "http://localhost:4000/assets/built/images/iot-logo.png",
        "width": 2000,
        "height": 666
    },
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://localhost:4000/can"
    },
    "description": "CAN 개요 CAN은 Controller Area Network의 약자로 1986년에 독일의 메르세데스 벤츠사의 요구 (자동차내의 3개의 서로다른 ECU간의 데이터 통신)로 자동차 부품회사인 로베르트 보쉬사가 개발해 자동차기술자 협회에서 제안한 네트워크 시스템입니다. ECU는 Electoric Control Unit의 약자로 자동차의 엔진, 자동변속기, ABS등의 상태를 컴퓨터로 제어하는 전자제어장치를 의미합니다. 이런 ECU들은 각 목적에 따라 차량안에 분산되어 위치하고"
}
    </script>

    <!-- <script type="text/et-cetera" src="https://demo.ghost.io/public/ghost-sdk.min.js?v=724281a32e"></script>
    <script type="text/et-cetera">
    ghost.init({
    	clientId: "ghost-frontend",
    	clientSecret: "f84a07a72b17"
    });
    </script> -->

    <!-- 사용자 browser 확인 코드 - Chrome이 아니면 경고 메시지 출력 -->

    <script>
        var agent = navigator.userAgent.toLowerCase();
        var _iPhone = false;
        var _chrome = false;
        var result = false;
        if (agent.indexOf("iphone") != -1) {
            _iPhone = true;
        }
        if (agent.indexOf("chrome") != -1) {
            _chrome = true;
        }

        if( _iPhone || _chrome ) {
            result = true;
        }

        if( !result ) {
            alert("이 블로그는 Google Chrome Browser에 최적화 되어 있습니다 !!");
        }

    </script>

    <meta name="generator" content="Jekyll 3.6.2" />
    <link rel="alternate" type="application/rss+xml" title="CAN Protocol" href="/feed.xml" />


</head>
<body class="post-template">

    <div class="site-wrapper">
        <!-- All the main content gets inserted here, index.hbs, post.hbs, etc -->
        <!-- default -->

<!-- The tag above means: insert everything in this file
into the {body} of the default.hbs template -->

<header class="site-header outer">
    <div class="inner">
        <nav class="site-nav">
    <div class="site-nav-left">
        
            
                <a class="site-nav-logo" href="http://localhost:4000">IT Technical Training</a>
            
        
        
            
<ul class="nav" role="menu">
<!--    <li class="nav-home" role="menuitem"><a href="/">Home</a></li>-->
    <li class="nav-about" role="menuitem"><a href="/about/">About</a></li>
<!--
    <li class="nav-data-analysis-article" role="menuitem"><a href="/author/data-analysis/">Data Analysis(R)</a></li>
    <li class="nav-python-article" role="menuitem"><a href="/author/python/">Python</a></li>
    <li class="nav-python-article" role="menuitem"><a href="/tag/jekyll/">Jekyll</a></li>
    <li class="nav-miscellaneous-article" role="menuitem"><a href="/author/fragmentary-knowledge/">Miscellaneous Article</a></li>
-->
<!--
    <li class="nav-archive" role="menuitem">
        <a href="/archive.html">All Posts</a>
    </li>
-->
    <li class="nav-python" role="menuitem">
        <a href="/tag/jekyll/">Jekyll Blog 생성</a>
    </li>
    <li class="nav-python" role="menuitem">
        <a href="/tag/python/">Python</a>
    </li>
    <li class="nav-data-science" role="menuitem">
        <a href="/tag/data-science/">Data Science</a>
    </li>
    <li class="nav-machine-learning" role="menuitem">
        <a href="/tag/machine-learning/">Machine Learning</a>
    </li>
    <li class="nav-python" role="menuitem">
        <a href="/tag/r/">R 기초강의</a>
    </li>
<!--    <li class="nav-python" role="menuitem">-->
<!--        <a href="/tag/angular/">Angular</a>-->
<!--    </li>-->
    <li class="nav-python" role="menuitem">
        <a href="/tag/et-cetera/">Et cetera</a>
    </li>
    <li class="nav-archive" role="menuitem">
        <a href="/author_archive.html">All Posts</a>
    </li>
</ul>

<!-- 아래 내용이 있으면 홈 화면 좌측 상단에 Navigation 버튼이 생성됨.. 굳이 필요없어서 comment 처리 -->

<!--
<nav id="dl-menu" class="dl-menuwrapper" role="navigation">
    <button class="dl-trigger">Open Menu</button>
    <ul class="dl-menu">
        <li><a href="http://localhost:4000/">Home</a></li>
        <li>
            <a href="#">About</a>
            <ul class="dl-submenu">
                <li style="text-align: center">
                    <img src="http://localhost:4000/assets/built/images/photo.jpg" alt="SungHoon Moon photo" class="author-photo">
                </li>
                <li>
                    <h4>SungHoon Moon</h4>
                    <p>Director of ATGLab. <br>Ph.D. in Computer Science</p>
                </li>
                <li><a href="http://localhost:4000/about/"><i class="fa fa-external-link"></i><span class="btn btn-inverse"> Learn More</span></a></li>
                <li>
                <a href="mailto:moon9342@gmail.com"><i class="fa fa-fw fa-envelope"></i> Email</a>
            </li>
                
                
                
                
                
                
                
                
                
            </ul>
        </li>
        <li>
            <a href="#">Posts</a>
            <ul class="dl-submenu">
                <li><a href="http://localhost:4000/archive">All Posts</a></li>
                <li><a href="http://localhost:4000/author_archive">All Tags</a></li>
            </ul>
        </li>
        
    </ul>
</nav>
-->
        
    </div>
    <div class="site-nav-right">
        <div class="social-links">
            
            
        </div>
        
            <a class="subscribe-button" href="#subscribe">Search</a>
        
    </div>
</nav>

    </div>
</header>

<!-- Everything inside the #post tags pulls data from the post -->
<!-- #post -->

<main id="site-main" class="site-main outer" role="main">
    <div class="inner">

        <article class="post-full post tag-front-end ">

            <header class="post-full-header">
                <section class="post-full-meta">
                    <time class="post-full-meta-date" datetime="16 February 2020">16 February 2020</time>
                    
                        <span class="date-divider">/</span>
                        
                            
                               <a href='/tag/et-cetera/'>ET-CETERA</a>
                            
                        
                    
                </section>
                <h1 class="post-full-title">CAN Protocol</h1>
            </header>

            
<!--
            post에 cover image를 표시하지 않게 설정
            <figure class="post-full-image" style="background-image: url(/assets/built/images/iot-logo.png)">
            </figure>
-->
            

            <section class="post-full-content">
                <div class="kg-card-markdown">
                    <p><strong><i class="fa fa-bolt" style="color:#01077c"></i> CAN 개요</strong></p>

<p><code class="highlighter-rouge">CAN</code>은 Controller Area Network의 약자로 1986년에 독일의 메르세데스 벤츠사의 요구
(자동차내의 3개의 서로다른 ECU간의 데이터 통신)로 자동차 부품회사인 로베르트 보쉬사가 개발해 
자동차기술자 협회에서 제안한 네트워크 시스템입니다.</p>

<p><code class="highlighter-rouge">ECU</code>는 Electoric Control Unit의 약자로 자동차의 엔진, 자동변속기, ABS등의 상태를 컴퓨터로 제어하는
전자제어장치를 의미합니다. 이런 ECU들은 각 목적에 따라 차량안에 분산되어 위치하고 있습니다.
여러 센서들로부터 데이터를 ECU가 받아들이고 다른 ECU와 통신해서 차량의 모든 부분을 제어하는 역할을 담당하고 있습니다.</p>

<p><img src="../../assets/built/images/iot-can-ecu.png" alt="차량의 ECU 연결" /></p>

<p>현재 현대차 Genesis는 약 70개의 ECU가 탑제되어 있고 벤츠 S클래스와 BMW 7시리즈에는 80여개의 ECU,
렉서스 LS시리즈에는 약 100개의 ECU가 탑제되어 있습니다.</p>

<p>대표적인 ECU를 몇가지 살펴보면,</p>

<ul>
  <li><strong><code class="highlighter-rouge">ACU</code>(Airbag Control Unit)</strong> : 자동차 충돌 상황의 센서 신호를 받아 Airbag을 제어하는 ECU.</li>
  <li><strong><code class="highlighter-rouge">BCM</code>(Body Control Module)</strong> : 자동차의 각종 경고, 도난방지 기능등을 제어하는 ECU.</li>
  <li><strong><code class="highlighter-rouge">ECU</code>(Engine Control Unit)</strong> : 엔진의 상태를 모니터링하면서 연료량, 점화시기등의 기능을 제어하는 ECU.</li>
  <li><strong><code class="highlighter-rouge">TCU</code>(Transmission Control Unit)</strong> : 자동차의 속도, 바퀴속도등의 값을 이용해 변속기를 제어하는 ECU.</li>
  <li><strong><code class="highlighter-rouge">ABS</code>(Anti-lock Breaking System)</strong> : 자동차가 미끄러지지 않도록 브레이크의 on/off를 짧은시간동안 반복 제어하는 ECU.</li>
</ul>

<p>시간상으로 보자면, 1986년에 CAN 1.0발표후에 1991년에 CAN 2.0이 발표되고 
1992년에 메르세데스 벤츠에서 CAN을 채택한 자동차가 출시되게 됩니다.
그리고 그 다음해인 1993년에 ISO에 의해서 국제표준규격으로 채택됩니다.</p>

<p>자동차내부의 통신은 CAN이 유일할까요? 그렇지는 않습니다. 시간이 지나면서 여러가지 형태의
네트워크가 개발, 발표되고 있습니다. (<code class="highlighter-rouge">FlexRay</code>, <code class="highlighter-rouge">LIN</code>, <code class="highlighter-rouge">CAN FD</code> 등)</p>

<p>그럼 CAN은 ECU간의 통신을 어떤 방식으로 할까요?</p>

<p>CAN은 ECU간의 통신을 위해 직렬(Serial) 네트워크 통신방식을 이용합니다. 
하나의 ECU가 시스템 안에 있는 다른 ECU에 대해 각각 입출력 단자를 갖는것이 아니라 
CAN BUS에 대한 단일 CAN Interface만을 보유하고 있는 것이 특징입니다.</p>

<p><img src="../../assets/built/images/iot-can-network.png" alt="CAN버스를 이용한 연결" /></p>

<p>자동차안에는 많은 ECU가 탑제되어 있고 이런 ECU간의 데이터 공유를 통해서 자동차가 제어됩니다.
자동차는 환경적으로 고온, 충격, 진동 노이즈가 많은 환경인데 이런 열악한 환경에서도 CAN은 잘 견디기 때문에
속도가 느림에도 불구하고 주력 차량 네트워크 통신 표준으로 사용되고 있습니다.</p>

<hr />

<p><strong><i class="fa fa-bolt" style="color:#01077c"></i> CAN 프로토콜의 장점</strong></p>

<ul>
  <li><strong>CAN 프로토콜은 Multi Master 통신을 한다.</strong> CAN BUS를 공유하고 있는 MCU들은 모두가 Master의 역할을 수행할 수 있으며
BUS가 idle상태이면 언제든지 BUS를 사용하고 싶을 때 사용할 수 있습니다.</li>
  <li><strong>노이즈에 매우 강하다.</strong> Twisted Pair Wire 2개를 사용하여 전기적 전압차를 이용한 통신을 하기 때문에 노이즈에 강합니다.</li>
  <li><strong>표준 프로토콜.</strong> CAN은 표준 프로토콜이기 때문에 시장성을 확보할 수 있습니다.</li>
  <li><strong>하드웨어적으로 오류보정이 가능.</strong> CRC가 하드웨어 적으로 생성되기 때문에 오류 검출이 가능하고 
만약 오류가 검출되었을 때 하드웨어적으로 재전송합니다.</li>
  <li><strong>다양한 방식의 통신.</strong> CAN은 수신필터를 이용하여 필터를 어떻게 설정하느냐에 따라
unicast, multicast, broadcast 통신을 할 수 있습니다.</li>
  <li><strong>ECU간의 우선순위가 존재.</strong> 각각의 ECU는 고유의 ID를 가지고 있는데 이 ID값이 낮을수록 우선순위가 높습니다. 
이 우선순위를 이용하면 급한 Message를 먼저 처리할 수 있습니다.</li>
  <li><strong>CAN BUS 이용.</strong> 사용되는 전선의 양을 획기적으로 줄일 수 있습니다.</li>
</ul>

<hr />

<p><strong><i class="fa fa-bolt" style="color:#01077c"></i> CAN 통신의 형태</strong></p>

<p>CAN 프로토콜 환경 구성은 <code class="highlighter-rouge">CAN Controller</code>와 <code class="highlighter-rouge">CAN Transceiver</code>로 구현되어있습니다. 
CAN Controller는 내부 버퍼를 가지며 CAN Transceiver의 수신 메시지에 대해 ID 값을 기반으로 
유효 데이터인지를 판별하여 MCU로 전송하는 역할을 수행합니다.</p>

<p>CAN통신은 일반적으로 다음의 두 가지 형태로 사용된다.</p>

<ol>
  <li>MCU(Micro Controller Unit) 내부에 CAN Controller가 존재(통합형)</li>
</ol>

<p><img src="../../assets/built/images/iot-can-controller-allinone.png" alt="통합형" /></p>

<ol>
  <li>MCU(Micro Controller Unit) 외부에 CAN Controller가 존재(독립형)</li>
</ol>

<p><img src="../../assets/built/images/iot-can-controller-independent.png" alt="독립형" /></p>

<hr />

<p><strong><i class="fa fa-bolt" style="color:#01077c"></i> CAN 프로토콜의 특징</strong></p>

<p>CAN 통신은 여러 개의 ECU를 CAN BUS에 병렬로 연결하여 데이터를 주고 받는 방식으로 
2가닥의 Twisted Pair Wire로 연결되어 있습니다.</p>

<p>또한 CAN BUS는 직렬통신 프로토콜을 사용하는데 직렬(Serial) 통신은 일반적으로 하나의 신호선을 이용하여 
데이터를 주고받는 통신을 지칭합니다. 신호선이 하나이기 때문에 데이터를 일정한 시간간격으로 전송하게 되며 
따라서 일정한 길이의 데이터를 보내기 위해서는 약간의 시간이 필요합니다.</p>

<p>데이터 전송에 약간의 시간이 필요하지만 적은 수의 신호선을 사용하기 때문에 비용을 절감할 수 있는 장점이 있습니다. 
이때문에 많은 통신장비들이 직렬통신으로 데이터를 전송합니다. Serial 통신의 대표적인 예가 USB, PC의 COM port이죠.</p>

<p>이와 반대로 병렬통신은 여러 개의 신호선을 이용하여 데이터를 전송하는 방식이기 때문에 단위시간당 더 많은 데이터를 
보낼 수 있지만 통신 거리가 길어질수록 많은 선들을 모두 연장해야 하므로 비용이 증가하게 되고 
최신 단말 장치들이 소형화 추세에 있는데 현실적으로 통신을 하기위한 I/O단자의 크기는 크게 줄일 수 없습니다. 
따라서 많은 I/O단자를 가지고 있는 병렬통신은 소형화된 기기에서 사용하기에 적합하지 않습니다.</p>

<p>CAN 통신은 주소를 이용한 통신이 아닌 ID를 이용한 통신으로 이 ID의 값에 따라 통신의 
우선순위가 결정됩니다.</p>

<p>각 ECU들은 BUS상에서 메시지를 주고 받기 때문에 기존의 ECU들은 새롭게 추가된 ECU에 대한 
정보를 Update할 필요가 없습니다.</p>

<p>CAN은 다중 통신망(Multi Master Network)이고 CSMA/CD(Carrier Sense Multiple Access/Collision Detection)방식을 
이용합니다. 즉, Ethernet 통신방식과 유사하다고 생각하시면 됩니다.</p>

<p>각 ECU는 메시지를 보내기 이전에 CAN BUS가 사용중인지를 파악(Carrier Sense)합니다. 메시지를 보낼 수 있을 때 
메시지를 보내며 수신측에서 CRC를 이용해 충돌이 발생했는지를 감지하고 만약 충돌이 발생하면 재전송하게됩니다.</p>

<p>보낸 메시지는 송신측이나 수신측의 주소를 포함하지 않습니다. 대신 메시지안에는 ID(11bit 혹은 29bit)가 포함되어 있습니다. 
CAN 메시지는 크게 ID Field와 Data Field를 가지고 있는데 ID Field는 ECU의 ID값이 될 수 있지만 “엔진 회전수”와 
같은 것을 나타내는 ID값이 될 수 도 있습니다. 이때 Data Field는 2000 rpm과 같은 값을 가지고 있게 되는 것이죠. 
이런 메시지인 경우 여러 ECU에서 해당 message를 수신해야 하는데 각 ECU는 ID MASK(Filter)를 이용하여 자신이 
받아들일 수 있는 메시지를 정해서 받습니다. 
ECU가 데이터를 전달 받으면 Receiver는 Ack를 신호를 생성하여 보내게 됩니다.</p>

<p>CAN 네트워크상의 모든 ECU는 네트워크 상의 메시지를 수신한 후 ID를 이용하여 자신에게 필요한 
메시지인지를 식별한 후 자신이 필요한 경우만 메시지를 취하고 그렇지 않으면 해당 메시지는 무시합니다.</p>

<p>CAN BUS상에 흐르는 여러 ECU의 데이터들이 동시에 하나의 ECU로 유입되는 경우 식별자(ID)의 숫자를 비교하여 
우선순위가 높은 메시지를 먼저 취합니다.</p>

<p>메시지를 보낼 경우 마찬가지로 우선 순위가 높은 메시지가 CAN BUS의 사용권한을 보장 받으며 낮은 순위의 메시지는 
다음 BUS cycle에 전송하게 됩니다.</p>

<hr />

<p><strong><i class="fa fa-bolt" style="color:#01077c"></i> CAN 프레임 구성</strong></p>

<p>CAN 통신은 프레임이라고 하는 패킷(packet)으로 데이터를 전송합니다. 
프레임이란 하나의 메시지를 이루는 필드 또는 bit들의 집합을 말하며 
CAN 프레임은 다음과 같은 분할 구역(section)으로 구성되어 있습니다.</p>

<p><img src="../../assets/built/images/iot-can-frame.png" alt="CAN Frame 구조" /></p>

<ul>
  <li><strong><code class="highlighter-rouge">SOF(Start Of Frame)</code></strong> : 메시지의 시작을 의미하는 비트로 버스의 노드(node)를 동기화하기 위해 사용됩니다.</li>
  <li><strong><code class="highlighter-rouge">Identifier(ID)</code></strong> : 식별자로서 메시지의 내용을 식별하고 메시지의 우선순위를 부여합니다. 
CAN 메시지에 있는 ID의 길이에 따라서 표준 CAN과 확장 CAN 두 가지로 구분됩니다. 
표준 CAN은 11 비트 식별자이고, 확장 CAN은 29비트 식별자로 구분됩니다.</li>
  <li><strong><code class="highlighter-rouge">Control</code></strong> : 데이터의 길이(DLC)를 의미합니다.</li>
  <li><strong><code class="highlighter-rouge">Data</code></strong> : 특정한 노드에서 다른 노드로 전송하는 데이터 포함하며 8Bytes까지 사용할 수 있습니다.</li>
  <li><strong><code class="highlighter-rouge">CRC</code></strong> : 프레임의 송신 오류 및 오류 검출에 사용됩니다.</li>
  <li><strong><code class="highlighter-rouge">ACK</code></strong> : 오류가 없는 메시지가 전송되었다는 것을 의미하는 비트로서, 
CAN 제어기는 메시지를 정확하게 수신했다면 ACK(Acknowledgement) 비트를 전송합니다. 
전송 노드는 버스 상에서 ACK 비트의 유무를 확인하고 만약 ACK 비트가 발견되지 않는다면 재전송을 시도합니다.
임의의 노드에서 올바른 메시지를 수신하게 되면 ACK 필드를 받는 순간 ACK 슬롯의 값을 ‘d’로 
설정해 Bus 상에서 계속 전송하게 됩니다.</li>
  <li><strong><code class="highlighter-rouge">EOF(End of Frame)</code></strong> :  프레임의 끝을 나타내고 종료를 의미합니다.</li>
</ul>

<hr />

<p><strong><i class="fa fa-bolt" style="color:#01077c"></i> CAN의 활용</strong></p>

<p>CAN 통신은 자동차 분야뿐만 아니라 자동화 기기, 의료 기기 그리고 로봇 등 다양한 분야에서도 널리 쓰이고 있기 때문에 
앞으로도 매우 중요하게 쓰일 통신방법이 될 것입니다.</p>

<p>두 개의 컴퓨터를 CAN 장비를 이용해서 Serial 연결 한 후 CANPro Analyzer를 이용하여 packet을 주고 받는
실습을 진행한 후 Java Program과 Arduino를 결합하여 실습을 진행합니다.</p>

<p><strong>CANPro 장비 연결</strong></p>

<ol>
  <li>
    <p>Windows 10은 디지털 서명 해제 작업을 먼저 선행해야 한다.
<a href="/assets/downloads/windows10_canpro_digitalSignature.pdf" target="_blank">디지털 서명 해제 for Windows10</a></p>
  </li>
  <li>
    <p>드라이버를 설치하지 않고 CANPro 장비의 USB를 PC에 연결하고
제어판 &gt; 하드웨어 및 소리 &gt; 장치관리자를 확인하면 기타장치 &gt; CANPro Analyzer가 
노란색 느낌표가 표시된 상태로 등록된것을 볼 수 있다.</p>
  </li>
  <li>
    <p>제공된 드라이버 폴더 RealSYS_USB_Device_Driver(20170316)안의 
dp-chooser.exe를 관리자 모드로 실행해서 개발툴용 USB Device Driver를 설치한다. 
설치가 완료되면 노란색 느낌표가 있던 기타장치는 사라지고
장치관리자 &gt; 포트 부분에 CANPro가 등록된걸 확인할 수 있다. (혹은 USB Serial Port로 등록)
정상적으로 설치가 되었으면 리부팅.</p>
  </li>
  <li>
    <p>드라이버에 설치하면 제공된 <code class="highlighter-rouge">CANPro Analyzer for Windows10</code>을 설치한다.</p>
  </li>
  <li>
    <p>총 3대의 컴퓨터(데스크탑 PC + 노트북 + 라떼판다)에 각각 CAN 장비(Controller + Transceiver)를 연결합니다.
CAN BUS가 존재하지 않기 때문에 3대를 연결하기 위해서는 아래 그림처럼 선을 겹쳐서 연결해야 합니다.</p>
  </li>
</ol>

<p><img src="../../assets/built/images/iot-can-3computer.png" alt="CAN 연결" /></p>

<p><strong>CANPro 장비 설정</strong></p>

<ul>
  <li>노트북을 기준으로 설명하면 CANPro Analyzer를 실행시킨 후 <code class="highlighter-rouge">동작 &gt; CANPro 환경 설정 쓰기</code>를 실행합니다.</li>
</ul>

<p><img src="../../assets/built/images/iot-canpro-setting-1.png" alt="CAN 환경설정-1" /></p>

<ul>
  <li>아래 그림과 같이 CANPro 장비 설정을 바꿉니다. PC통신 인터페이스는 <code class="highlighter-rouge">Serial 통신</code>으로 설정해야 하고 
적절한 <code class="highlighter-rouge">Serial 통신 포트</code>를 설정해야 합니다. <code class="highlighter-rouge">Serial 통신 속도</code>부분과 <code class="highlighter-rouge">프로토콜</code>, <code class="highlighter-rouge">CAN BPS</code>부분은 
다른 PC의 설정들과 동일하게 설정해야 합니다. <code class="highlighter-rouge">수신 ID</code>는 자신의 수신 ID를 설정하는 부분입니다. 다른
장비과 구분되게 설정합니다. 설정버튼을 누르면 현재 설정대로 CAN장비의 설정을 변경합니다.</li>
</ul>

<p><img src="../../assets/built/images/iot-canpro-setting-2.png" alt="CAN 환경설정-2" /></p>

<ul>
  <li><code class="highlighter-rouge">동작 &gt; CANPro 환경 설정 읽기</code>를 실행해서 설정한 내용을 읽어와서 정상적으로 설정이 됬는지 확인합니다. 
데이터를 받기 위해서는 <code class="highlighter-rouge">동작 &gt; CAN 데이터 수신 시작</code>을 실행하여 데이터 수신을 시작해야 다른 CAN장비로부터
들어오는 packet을 받을 수 있습니다.</li>
</ul>

<p><img src="../../assets/built/images/iot-canpro-setting-3.png" alt="CAN 환경설정-3" /></p>

<ul>
  <li>데스크탑 PC와 노트북을 CAN장비로 연결한 후 packet을 보내고 받는 영상입니다. 수신 MASK ID를 설정하지
않았기 때문에 모든 packet을 다 받습니다.</li>
</ul>

<iframe width="560" height="420" src="https://www.youtube.com/embed/Oin10Sq2SXU"></iframe>

<ul>
  <li>CAN Message 수신시 특정한 ID 또는 어떤 범위의 ID만 받고자 할때 MASK를 이용합니다.
Mask는 Filter의 사용여부(Enable/Disable)를 결정합니다. 즉, 실제 Message ID가 CAN Rx에 수신 되었을 때, 
Filter의 각 bit값이 비교 되어 같은지 다른지 판단하여 수용하게 됩니다. 이때 각 Filter bit값이 비교 되기 
위해서는 이에 대응되는 Mask bit가 Enable,즉 1이 되어야 합니다. 
따라서 0일때는 Filter bit값에 상관없이 모두 수용하게 되는 것입니다. 이 부분은 실제 실습을 통해서 확인해야 할 듯 합니다.</li>
</ul>

<hr />

<p><strong><i class="fa fa-bolt" style="color:#01077c"></i> Java 프로그램을 이용한 CAN 활용</strong></p>

<p>CANPro Analyzer를 이용하여 CANPro 환경설정과 데이터의 이동, MASK를 이용한 멀티캐스트를 이해했다면 
이제 Java 코드를 이용하여 CANPro를 통해 데이터를 주고 받아보겠습니다. 즉, Analyzer프로그램 대신
Java Program을 이용하겠다는 의미입니다.</p>

<p><a href="/assets/downloads/CANPro_User_Manual.pdf" target="_blank">CANPro 통신 프로토콜 사용자 메뉴얼</a>을 참고하여 프로그램을 작성해야 합니다.</p>

<ul>
  <li>DataFrame Sender (Using JavaFX)</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exam01_DataFrameSender</span> <span class="kd">extends</span> <span class="n">Application</span><span class="o">{</span>

	<span class="n">TextArea</span> <span class="n">textarea</span><span class="o">;</span>    <span class="c1">// 메시지창 </span>
	<span class="n">Button</span> <span class="n">connBtn</span><span class="o">,</span> <span class="n">sendBtn</span><span class="o">;</span>    <span class="c1">// 포트 연결 버튼, Data Frame 보내기 버튼</span>
	
	<span class="kd">private</span> <span class="n">CommPortIdentifier</span> <span class="n">portIdentifier</span><span class="o">;</span>
	<span class="kd">private</span> <span class="n">CommPort</span> <span class="n">commPort</span><span class="o">;</span>
	<span class="kd">private</span> <span class="n">SerialPort</span> <span class="n">serialPort</span><span class="o">;</span>
	
	<span class="kd">private</span> <span class="n">OutputStream</span> <span class="n">out</span><span class="o">;</span>
	
	<span class="c1">// TextArea에 문자열 출력하기 위한 method</span>
	<span class="kd">private</span> <span class="kt">void</span> <span class="nf">printMSG</span><span class="o">(</span><span class="n">String</span> <span class="n">msg</span><span class="o">)</span> <span class="o">{</span>
		<span class="n">Platform</span><span class="o">.</span><span class="na">runLater</span><span class="o">(()-&gt;{</span>
			<span class="n">textarea</span><span class="o">.</span><span class="na">appendText</span><span class="o">(</span><span class="n">msg</span> <span class="o">+</span> <span class="s">"\n"</span><span class="o">);</span>
		<span class="o">});</span>
	<span class="o">}</span>
	
	<span class="kd">private</span> <span class="kt">void</span> <span class="nf">connectPort</span><span class="o">(</span><span class="n">String</span> <span class="n">portName</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="n">portIdentifier</span> <span class="o">=</span> <span class="n">CommPortIdentifier</span><span class="o">.</span><span class="na">getPortIdentifier</span><span class="o">(</span><span class="n">portName</span><span class="o">);</span>
			<span class="n">printMSG</span><span class="o">(</span><span class="n">portName</span> <span class="o">+</span> <span class="s">"에 연결을 시도합니다!!"</span><span class="o">);</span>
			
			<span class="k">if</span><span class="o">(</span><span class="n">portIdentifier</span><span class="o">.</span><span class="na">isCurrentlyOwned</span><span class="o">())</span> <span class="o">{</span>
				<span class="n">printMSG</span><span class="o">(</span><span class="n">portName</span> <span class="o">+</span> <span class="s">"가 현재 다른 프로그램에 의해 사용중입니다. "</span><span class="o">);</span>				
			<span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
				<span class="c1">// 포트를 열고 포트객체를 얻는다.</span>
				<span class="c1">// open()의 첫번째 인자 : Name of application making this call.</span>
				<span class="c1">// open()의 두번째 인자 : Time in milliseconds to block waiting for port open.</span>
				<span class="n">commPort</span> <span class="o">=</span> <span class="n">portIdentifier</span><span class="o">.</span><span class="na">open</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">getClass</span><span class="o">().</span><span class="na">getName</span><span class="o">(),</span> <span class="mi">5000</span><span class="o">);</span>
				<span class="k">if</span><span class="o">(</span> <span class="n">commPort</span> <span class="k">instanceof</span> <span class="n">SerialPort</span> <span class="o">)</span> <span class="o">{</span>
					<span class="n">serialPort</span> <span class="o">=</span> <span class="o">(</span><span class="n">SerialPort</span><span class="o">)</span> <span class="n">commPort</span><span class="o">;</span>
					<span class="n">serialPort</span><span class="o">.</span><span class="na">setSerialPortParams</span><span class="o">(</span><span class="mi">9600</span><span class="o">,</span> <span class="c1">// 통신속도</span>
							<span class="n">SerialPort</span><span class="o">.</span><span class="na">DATABITS_8</span><span class="o">,</span> <span class="c1">// 데이터 비트 </span>
							<span class="n">SerialPort</span><span class="o">.</span><span class="na">STOPBITS_1</span><span class="o">,</span> <span class="c1">// Stop 비트 </span>
							<span class="n">SerialPort</span><span class="o">.</span><span class="na">PARITY_NONE</span><span class="o">);</span>  <span class="c1">// Parity 비트</span>
					<span class="c1">// OutputStream 생성</span>
					<span class="n">out</span> <span class="o">=</span> <span class="n">serialPort</span><span class="o">.</span><span class="na">getOutputStream</span><span class="o">();</span> 
					<span class="n">printMSG</span><span class="o">(</span><span class="s">"성공적으로 "</span> <span class="o">+</span> <span class="n">portName</span> <span class="o">+</span> <span class="s">"에 접속되었습니다.!!"</span><span class="o">);</span>
				<span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
					<span class="n">printMSG</span><span class="o">(</span><span class="s">"Serial Port만 사용할 수 있습니다.!!"</span><span class="o">);</span>	
				<span class="o">}</span>
			<span class="o">}</span>
		<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
			<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
		<span class="o">}</span>
	<span class="o">}</span>
	
	<span class="kd">private</span> <span class="kt">void</span> <span class="nf">sendDataFrame</span><span class="o">(</span><span class="n">String</span> <span class="n">msg</span><span class="o">)</span> <span class="o">{</span>
		<span class="c1">// String msg = "W" + "28" + "10003B01" + "0000000000005011";</span>
		<span class="c1">// 데이터프레임 전송</span>
		<span class="c1">// CAN 네트워크상에 특정 CAN Message를 보내고자 할 때</span>
		<span class="c1">// 시작문자 =&gt; 1문자 =&gt; ":" 이용</span>
		<span class="c1">// 명령코드 =&gt; 1문자 =&gt; "W" (전송)</span>
		<span class="c1">// 송신데이터 특성코드 =&gt; 2문자</span>
		<span class="c1">//                   5번째 bit가 0이면 CAN2.0A, 1이면 CAN2.0B를 나타냄</span>
		<span class="c1">//                   4번째 bit가 0이면 Data Frame을 지칭, 1이면 Remote Frame</span>
		<span class="c1">//                   3번째~0번째는 송신데이터의 길이(0부터 8까지의 값을 가지게 된다.)</span>
		<span class="c1">//                   예) 28 =&gt; 00101000 =&gt; CAN2.0B이면서 데이터 길이가 8인</span>
		<span class="c1">//                             Data Frame을 의미.</span>
		<span class="c1">// CAN 송신 ID =&gt; 4문자(11bit사용시) 혹은 8문자(29bit사용시)</span>
		<span class="c1">//               16진수로 표현하고 4bit가 1문자로 표현되기때문에 29bit를 표현하기 위해서는</span>
		<span class="c1">//               8개의 16진수가 필요하고 문자로 표현.</span>
		<span class="c1">//               예) 041C0800 =&gt; 0번부터 28번 비트중에</span>
		<span class="c1">//                            =&gt; 26번, 20번, 19번, 18번, 11번 bit가 check</span>
		<span class="c1">// CAN 송신 Data =&gt; 위에서 정의한 송신데이터 특성 코드 중 송신데이터의 길이에 따라</span>
		<span class="c1">//              =&gt; 0 ~ 16문자를 표현</span>
		<span class="c1">//              =&gt; 예) 데이터 프레임 개수(송신데이터의 길이)가 8이면 ASCII형식으로는</span>
		<span class="c1">//                     8개의 문자로 Hex표현이면 16개의 문자로 표현</span>
		<span class="c1">// Checksum =&gt; 2문자(수식에 의한 Checksum계산)                       </span>
		<span class="c1">// 끝 문자 =&gt; 1문자 ( "\r" 사용 )</span>
		
		<span class="n">msg</span> <span class="o">=</span> <span class="n">msg</span><span class="o">.</span><span class="na">toUpperCase</span><span class="o">();</span>
		<span class="kt">char</span> <span class="n">c</span><span class="o">[]</span> <span class="o">=</span> <span class="n">msg</span><span class="o">.</span><span class="na">toCharArray</span><span class="o">();</span>
		<span class="kt">int</span> <span class="n">checksumData</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
		<span class="k">for</span> <span class="o">(</span><span class="kt">char</span> <span class="n">cc</span> <span class="o">:</span> <span class="n">c</span><span class="o">)</span> <span class="o">{</span>
			<span class="n">checksumData</span> <span class="o">+=</span> <span class="n">cc</span><span class="o">;</span>
		<span class="o">}</span>
		<span class="n">checksumData</span> <span class="o">=</span> <span class="o">(</span><span class="n">checksumData</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="o">);</span>
		<span class="n">String</span> <span class="n">sendMsg</span> <span class="o">=</span> <span class="s">":"</span> <span class="o">+</span> <span class="n">msg</span> <span class="o">+</span> 
				<span class="n">Integer</span><span class="o">.</span><span class="na">toHexString</span><span class="o">(</span><span class="n">checksumData</span><span class="o">).</span><span class="na">toUpperCase</span><span class="o">()</span> <span class="o">+</span> <span class="s">"\r"</span><span class="o">;</span>
		
		<span class="n">printMSG</span><span class="o">(</span><span class="s">"생성된 전송 메시지 : "</span> <span class="o">+</span> <span class="n">sendMsg</span><span class="o">);</span>
		
		<span class="c1">// 전송할 byte배열 생성</span>
		<span class="kt">byte</span><span class="o">[]</span> <span class="n">inputData</span> <span class="o">=</span> <span class="n">sendMsg</span><span class="o">.</span><span class="na">getBytes</span><span class="o">();</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="n">out</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">inputData</span><span class="o">);</span>
			<span class="c1">//out.flush();</span>
			<span class="n">printMSG</span><span class="o">(</span><span class="s">"성공적으로 전송되었습니다.!!"</span><span class="o">);</span>
		<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e1</span><span class="o">)</span> <span class="o">{</span>
			<span class="n">e1</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
		<span class="o">}</span>					
	<span class="o">}</span>
	
	<span class="nd">@Override</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">start</span><span class="o">(</span><span class="n">Stage</span> <span class="n">primaryStage</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>

		<span class="n">BorderPane</span> <span class="n">root</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BorderPane</span><span class="o">();</span>
		<span class="n">root</span><span class="o">.</span><span class="na">setPrefSize</span><span class="o">(</span><span class="mi">700</span><span class="o">,</span> <span class="mi">500</span><span class="o">);</span>
		
		<span class="n">textarea</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TextArea</span><span class="o">();</span>
		<span class="n">root</span><span class="o">.</span><span class="na">setCenter</span><span class="o">(</span><span class="n">textarea</span><span class="o">);</span>
			
		<span class="n">connBtn</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Button</span><span class="o">(</span><span class="s">"COM 포트 접속"</span><span class="o">);</span>
		<span class="n">connBtn</span><span class="o">.</span><span class="na">setPrefSize</span><span class="o">(</span><span class="mi">200</span><span class="o">,</span> <span class="mi">50</span><span class="o">);</span>
		<span class="n">connBtn</span><span class="o">.</span><span class="na">setPadding</span><span class="o">(</span><span class="k">new</span> <span class="n">Insets</span><span class="o">(</span><span class="mi">10</span><span class="o">));</span>
		<span class="n">connBtn</span><span class="o">.</span><span class="na">setOnAction</span><span class="o">(</span><span class="n">e</span><span class="o">-&gt;{</span>
			<span class="n">String</span> <span class="n">portName</span> <span class="o">=</span> <span class="s">"COM16"</span><span class="o">;</span>
			<span class="c1">// 포트 접속</span>
			<span class="n">connectPort</span><span class="o">(</span><span class="n">portName</span><span class="o">);</span>
		<span class="o">});</span>
		
		<span class="n">sendBtn</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Button</span><span class="o">(</span><span class="s">"Data Frame 전송"</span><span class="o">);</span>
		<span class="n">sendBtn</span><span class="o">.</span><span class="na">setPrefSize</span><span class="o">(</span><span class="mi">200</span><span class="o">,</span> <span class="mi">50</span><span class="o">);</span>
		<span class="n">sendBtn</span><span class="o">.</span><span class="na">setPadding</span><span class="o">(</span><span class="k">new</span> <span class="n">Insets</span><span class="o">(</span><span class="mi">10</span><span class="o">));</span>
		<span class="n">sendBtn</span><span class="o">.</span><span class="na">setOnAction</span><span class="o">(</span><span class="n">e</span><span class="o">-&gt;{</span>
			<span class="c1">// Data Frame 전송</span>
			<span class="n">String</span> <span class="n">msg</span> <span class="o">=</span> <span class="s">"W"</span> <span class="o">+</span> <span class="s">"28"</span> <span class="o">+</span> <span class="s">"10003B01"</span> <span class="o">+</span> <span class="s">"0000000000005011"</span><span class="o">;</span>
			<span class="n">sendDataFrame</span><span class="o">(</span><span class="n">msg</span><span class="o">);</span>			
		<span class="o">});</span>				
		
		<span class="n">FlowPane</span> <span class="n">flowPane</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FlowPane</span><span class="o">();</span>
		<span class="n">flowPane</span><span class="o">.</span><span class="na">setPrefSize</span><span class="o">(</span><span class="mi">700</span><span class="o">,</span> <span class="mi">50</span><span class="o">);</span>
		<span class="n">flowPane</span><span class="o">.</span><span class="na">setHgap</span><span class="o">(</span><span class="mi">10</span><span class="o">);</span>
		<span class="n">flowPane</span><span class="o">.</span><span class="na">getChildren</span><span class="o">().</span><span class="na">add</span><span class="o">(</span><span class="n">connBtn</span><span class="o">);</span>
		<span class="n">flowPane</span><span class="o">.</span><span class="na">getChildren</span><span class="o">().</span><span class="na">add</span><span class="o">(</span><span class="n">sendBtn</span><span class="o">);</span>
		
		<span class="n">root</span><span class="o">.</span><span class="na">setBottom</span><span class="o">(</span><span class="n">flowPane</span><span class="o">);</span>
		
		<span class="n">Scene</span> <span class="n">scene</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Scene</span><span class="o">(</span><span class="n">root</span><span class="o">);</span>
		<span class="n">primaryStage</span><span class="o">.</span><span class="na">setScene</span><span class="o">(</span><span class="n">scene</span><span class="o">);</span>
		<span class="n">primaryStage</span><span class="o">.</span><span class="na">setTitle</span><span class="o">(</span><span class="s">"CAN DataFrame Send Test"</span><span class="o">);</span>
		<span class="n">primaryStage</span><span class="o">.</span><span class="na">setOnCloseRequest</span><span class="o">(</span><span class="n">e</span><span class="o">-&gt;{</span>
			<span class="n">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
		<span class="o">});</span>
		<span class="n">primaryStage</span><span class="o">.</span><span class="na">show</span><span class="o">();</span>
		
	<span class="o">}</span>
	 
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
		<span class="n">launch</span><span class="o">();</span>
	<span class="o">}</span>		
<span class="o">}</span>
</code></pre></div></div>

<ul>
  <li>DataFrame Receiver &amp; 환경설정</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exam02_DataFrameReceiver</span> <span class="kd">extends</span> <span class="n">Application</span> <span class="o">{</span>

	<span class="n">TextArea</span> <span class="n">textarea</span><span class="o">;</span>
	<span class="c1">// 포트접속버튼, 환경쓰기버튼, 데이터수신가능버튼, 데이터수신가능버튼</span>
	<span class="n">Button</span> <span class="n">connBtn</span><span class="o">,</span> <span class="n">envBtn</span><span class="o">,</span> <span class="n">revEnableBtn</span><span class="o">,</span> <span class="n">revDisableBtn</span><span class="o">;</span>
		
	<span class="kd">private</span> <span class="n">CommPortIdentifier</span> <span class="n">portIdentifier</span><span class="o">;</span>
	<span class="kd">private</span> <span class="n">CommPort</span> <span class="n">commPort</span><span class="o">;</span>
	<span class="kd">private</span> <span class="n">SerialPort</span> <span class="n">serialPort</span><span class="o">;</span>
	
	<span class="kd">private</span> <span class="n">BufferedInputStream</span> <span class="n">bin</span><span class="o">;</span>
	<span class="kd">private</span> <span class="n">OutputStream</span> <span class="n">out</span><span class="o">;</span>
	
	
	<span class="kd">class</span> <span class="nc">MyPortListener</span> <span class="kd">implements</span> <span class="n">SerialPortEventListener</span> <span class="o">{</span>
		<span class="nd">@Override</span>
		<span class="kd">public</span> <span class="kt">void</span> <span class="nf">serialEvent</span><span class="o">(</span><span class="n">SerialPortEvent</span> <span class="n">event</span><span class="o">)</span> <span class="o">{</span>
			<span class="k">if</span> <span class="o">(</span><span class="n">event</span><span class="o">.</span><span class="na">getEventType</span><span class="o">()</span> <span class="o">==</span> <span class="n">SerialPortEvent</span><span class="o">.</span><span class="na">DATA_AVAILABLE</span><span class="o">)</span> <span class="o">{</span>
				<span class="kt">byte</span><span class="o">[]</span> <span class="n">readBuffer</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="mi">128</span><span class="o">];</span>
				<span class="k">try</span> <span class="o">{</span> 
					<span class="k">while</span> <span class="o">(</span><span class="n">bin</span><span class="o">.</span><span class="na">available</span><span class="o">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
						<span class="n">bin</span><span class="o">.</span><span class="na">read</span><span class="o">(</span><span class="n">readBuffer</span><span class="o">);</span>
					<span class="o">}</span>
					<span class="n">String</span> <span class="n">revData</span> <span class="o">=</span> <span class="k">new</span> <span class="n">String</span><span class="o">(</span><span class="n">readBuffer</span><span class="o">);</span>
					<span class="n">printMSG</span><span class="o">(</span><span class="s">"Receive Low Data:"</span> <span class="o">+</span> <span class="n">revData</span><span class="o">);</span>	
					<span class="k">if</span><span class="o">(</span><span class="n">revData</span><span class="o">.</span><span class="na">trim</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="s">":G01A8"</span><span class="o">))</span> <span class="o">{</span>
						<span class="n">printMSG</span><span class="o">(</span><span class="s">"지금부터 데이터 수신 가능합니다."</span><span class="o">);</span>
					<span class="o">}</span>
					<span class="k">if</span><span class="o">(</span><span class="n">revData</span><span class="o">.</span><span class="na">trim</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="s">":G00A7"</span><span class="o">))</span> <span class="o">{</span>
						<span class="n">printMSG</span><span class="o">(</span><span class="s">"지금부터 데이터 수신이 불가능합니다."</span><span class="o">);</span>
					<span class="o">}</span>	
					<span class="c1">// CAN 수신 데이터 읽기 </span>
					<span class="c1">// U2800000001111100000000000044</span>
					<span class="c1">// 시작문자 =&gt; :</span>
					<span class="c1">// 명령코드 =&gt; U</span>
					<span class="c1">// 수신데이터 특성코드 : 0010 1000 =&gt; 28</span>
					<span class="c1">// CAN 수신 ID : 00000001</span>
					<span class="c1">// CAN 수신 데이터 : 1111000000000000</span>
					<span class="c1">// checksum : 44</span>
					<span class="k">if</span><span class="o">(</span><span class="n">revData</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="o">==</span> <span class="sc">'U'</span><span class="o">)</span> <span class="o">{</span>
						<span class="n">printMSG</span><span class="o">(</span><span class="s">"데이터를 수신했습니다."</span><span class="o">);</span>
					<span class="o">}</span>
				<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
					<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
				<span class="o">}</span>				
			<span class="o">}</span>		
		<span class="o">}</span>		
	<span class="o">}</span>
	
	<span class="c1">// TextArea에 문자열 출력하기 위한 method</span>
	<span class="kd">private</span> <span class="kt">void</span> <span class="nf">printMSG</span><span class="o">(</span><span class="n">String</span> <span class="n">msg</span><span class="o">)</span> <span class="o">{</span>
		<span class="n">Platform</span><span class="o">.</span><span class="na">runLater</span><span class="o">(()-&gt;{</span>
			<span class="n">textarea</span><span class="o">.</span><span class="na">appendText</span><span class="o">(</span><span class="n">msg</span> <span class="o">+</span> <span class="s">"\n"</span><span class="o">);</span>
		<span class="o">});</span>
	<span class="o">}</span>
	
	<span class="kd">private</span> <span class="kt">void</span> <span class="nf">connectPort</span><span class="o">(</span><span class="n">String</span> <span class="n">portName</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="n">portIdentifier</span> <span class="o">=</span> <span class="n">CommPortIdentifier</span><span class="o">.</span><span class="na">getPortIdentifier</span><span class="o">(</span><span class="n">portName</span><span class="o">);</span>
			<span class="n">printMSG</span><span class="o">(</span><span class="n">portName</span> <span class="o">+</span> <span class="s">"에 연결을 시도합니다!!"</span><span class="o">);</span>
			
			<span class="k">if</span><span class="o">(</span><span class="n">portIdentifier</span><span class="o">.</span><span class="na">isCurrentlyOwned</span><span class="o">())</span> <span class="o">{</span>
				<span class="n">printMSG</span><span class="o">(</span><span class="n">portName</span> <span class="o">+</span> <span class="s">"가 현재 다른 프로그램에 의해 사용중입니다. "</span><span class="o">);</span>				
			<span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
				<span class="c1">// 포트를 열고 포트객체를 얻는다.</span>
				<span class="c1">// open()의 첫번째 인자 : Name of application making this call.</span>
				<span class="c1">// open()의 두번째 인자 : Time in milliseconds to block waiting for port open.</span>
				<span class="n">commPort</span> <span class="o">=</span> <span class="n">portIdentifier</span><span class="o">.</span><span class="na">open</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">getClass</span><span class="o">().</span><span class="na">getName</span><span class="o">(),</span> <span class="mi">5000</span><span class="o">);</span>
				<span class="k">if</span><span class="o">(</span> <span class="n">commPort</span> <span class="k">instanceof</span> <span class="n">SerialPort</span> <span class="o">)</span> <span class="o">{</span>
					<span class="n">serialPort</span> <span class="o">=</span> <span class="o">(</span><span class="n">SerialPort</span><span class="o">)</span> <span class="n">commPort</span><span class="o">;</span>
					<span class="n">serialPort</span><span class="o">.</span><span class="na">setSerialPortParams</span><span class="o">(</span><span class="mi">921600</span><span class="o">,</span> <span class="c1">// 통신속도</span>
							<span class="n">SerialPort</span><span class="o">.</span><span class="na">DATABITS_8</span><span class="o">,</span> <span class="c1">// 데이터 비트 </span>
							<span class="n">SerialPort</span><span class="o">.</span><span class="na">STOPBITS_1</span><span class="o">,</span> <span class="c1">// Stop 비트 </span>
							<span class="n">SerialPort</span><span class="o">.</span><span class="na">PARITY_NONE</span><span class="o">);</span>  <span class="c1">// Parity 비트</span>
			        <span class="n">printMSG</span><span class="o">(</span><span class="n">portName</span> <span class="o">+</span> <span class="s">"에 이벤트 리스너가 등록되었습니다."</span><span class="o">);</span>
					<span class="c1">// Stream 생성</span>
					<span class="n">bin</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedInputStream</span><span class="o">(</span><span class="n">serialPort</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">());</span>
					<span class="n">out</span> <span class="o">=</span> <span class="n">serialPort</span><span class="o">.</span><span class="na">getOutputStream</span><span class="o">();</span> 
					<span class="n">printMSG</span><span class="o">(</span><span class="s">"성공적으로 "</span> <span class="o">+</span> <span class="n">portName</span> <span class="o">+</span> <span class="s">"에 접속되었습니다.!!"</span><span class="o">);</span>
				    <span class="n">serialPort</span><span class="o">.</span><span class="na">addEventListener</span><span class="o">(</span><span class="k">new</span> <span class="n">MyPortListener</span><span class="o">());</span>
				    <span class="n">serialPort</span><span class="o">.</span><span class="na">notifyOnDataAvailable</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
				<span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
					<span class="n">printMSG</span><span class="o">(</span><span class="s">"Serial Port만 사용할 수 있습니다.!!"</span><span class="o">);</span>	
				<span class="o">}</span>
			<span class="o">}</span>
		<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
			<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
		<span class="o">}</span>
	<span class="o">}</span>
	
	
	<span class="nd">@Override</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">start</span><span class="o">(</span><span class="n">Stage</span> <span class="n">primaryStage</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>

		<span class="n">BorderPane</span> <span class="n">root</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BorderPane</span><span class="o">();</span>
		<span class="n">root</span><span class="o">.</span><span class="na">setPrefSize</span><span class="o">(</span><span class="mi">850</span><span class="o">,</span> <span class="mi">500</span><span class="o">);</span>
		
		<span class="n">textarea</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TextArea</span><span class="o">();</span>
		<span class="n">root</span><span class="o">.</span><span class="na">setCenter</span><span class="o">(</span><span class="n">textarea</span><span class="o">);</span>
		
		<span class="n">connBtn</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Button</span><span class="o">(</span><span class="s">"Serial 포트 접속"</span><span class="o">);</span>
		<span class="n">connBtn</span><span class="o">.</span><span class="na">setPrefSize</span><span class="o">(</span><span class="mi">200</span><span class="o">,</span> <span class="mi">50</span><span class="o">);</span>
		<span class="n">connBtn</span><span class="o">.</span><span class="na">setPadding</span><span class="o">(</span><span class="k">new</span> <span class="n">Insets</span><span class="o">(</span><span class="mi">10</span><span class="o">));</span>
		<span class="n">connBtn</span><span class="o">.</span><span class="na">setOnAction</span><span class="o">(</span><span class="n">e</span><span class="o">-&gt;{</span>
			<span class="n">String</span> <span class="n">portName</span> <span class="o">=</span> <span class="s">"COM16"</span><span class="o">;</span>
			<span class="n">connectPort</span><span class="o">(</span><span class="n">portName</span><span class="o">);</span>
		<span class="o">});</span>				
		
		<span class="n">revEnableBtn</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Button</span><span class="o">(</span><span class="s">"데이터수신가능"</span><span class="o">);</span>
		<span class="n">revEnableBtn</span><span class="o">.</span><span class="na">setPrefSize</span><span class="o">(</span><span class="mi">200</span><span class="o">,</span> <span class="mi">50</span><span class="o">);</span>
		<span class="n">revEnableBtn</span><span class="o">.</span><span class="na">setPadding</span><span class="o">(</span><span class="k">new</span> <span class="n">Insets</span><span class="o">(</span><span class="mi">10</span><span class="o">));</span>
		<span class="n">revEnableBtn</span><span class="o">.</span><span class="na">setOnAction</span><span class="o">(</span><span class="n">e</span><span class="o">-&gt;{</span>
			<span class="c1">// CAN 데이터 수신 여부 설정</span>
			<span class="c1">// 시작문자 =&gt; 1문자 =&gt; ":" 이용</span>
			<span class="c1">// 명령코드 =&gt; 1문자 =&gt; "G"</span>
			<span class="c1">// 수신 여부 명령 코드 =&gt; 2문자</span>
			<span class="c1">//                   00 : 현재 CANPro의 CAN 데이터 수신 여부 환경을 읽어온다.</span>
			<span class="c1">//                   10 : CANPro의 CAN 데이터 수신 동작을 중지한다.</span>
			<span class="c1">//                   11 : CANPro의 CAN 데이터 수신 동작을 시작한다.</span>
			<span class="c1">// Check Sum =&gt; 2문자</span>
			<span class="n">String</span> <span class="n">str</span> <span class="o">=</span> <span class="s">"G11"</span><span class="o">;</span>
			<span class="n">String</span> <span class="n">tmpStr</span> <span class="o">=</span> <span class="n">str</span><span class="o">.</span><span class="na">toUpperCase</span><span class="o">();</span>
			<span class="kt">char</span> <span class="n">c</span><span class="o">[]</span> <span class="o">=</span> <span class="n">tmpStr</span><span class="o">.</span><span class="na">toCharArray</span><span class="o">();</span>
			<span class="kt">int</span> <span class="n">checksumData</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
			<span class="k">for</span> <span class="o">(</span><span class="kt">char</span> <span class="n">cc</span> <span class="o">:</span> <span class="n">c</span><span class="o">)</span> <span class="o">{</span>
				<span class="n">checksumData</span> <span class="o">+=</span> <span class="n">cc</span><span class="o">;</span>
			<span class="o">}</span>
			<span class="n">checksumData</span> <span class="o">=</span> <span class="o">(</span><span class="n">checksumData</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="o">);</span>
			<span class="n">String</span> <span class="n">checksumHexString</span> <span class="o">=</span> <span class="n">Integer</span><span class="o">.</span><span class="na">toHexString</span><span class="o">(</span><span class="n">checksumData</span><span class="o">).</span><span class="na">toUpperCase</span><span class="o">();</span>
			<span class="c1">//printMSG("checksum계산값 : " + checksumHexString);</span>
			
			<span class="c1">// 끝문자 =&gt; 1문자 =&gt; "\r" 이용			</span>
			<span class="c1">// String msg = ":G11A9\r";</span>
			<span class="n">String</span> <span class="n">msg</span> <span class="o">=</span> <span class="s">":"</span> <span class="o">+</span> <span class="n">str</span> <span class="o">+</span> <span class="n">checksumHexString</span> <span class="o">+</span> <span class="s">"\r"</span><span class="o">;</span>
			
			<span class="k">try</span> <span class="o">{</span>
				<span class="kt">byte</span><span class="o">[]</span> <span class="n">inputData</span> <span class="o">=</span> <span class="n">msg</span><span class="o">.</span><span class="na">getBytes</span><span class="o">();</span>
				<span class="n">out</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">inputData</span><span class="o">);</span>
				<span class="c1">// 정상응답이 올경우</span>
				<span class="c1">// ":G01A8"   =&gt; 00의 의미는 현재 CAN 데이터 수신 동작이 중지.</span>
				<span class="c1">//            =&gt; 01의 의미는 현재 CAN 데이터 수신 동작이 시작.</span>
				<span class="c1">//            =&gt; A8의 의미는 G01에 대한 checksum         </span>
				
			<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e1</span><span class="o">)</span> <span class="o">{</span>
				<span class="n">e1</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
			<span class="o">}</span>
		<span class="o">});</span>				
		
		<span class="n">revDisableBtn</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Button</span><span class="o">(</span><span class="s">"데이터수신중지"</span><span class="o">);</span>
		<span class="n">revDisableBtn</span><span class="o">.</span><span class="na">setPrefSize</span><span class="o">(</span><span class="mi">200</span><span class="o">,</span> <span class="mi">50</span><span class="o">);</span>
		<span class="n">revDisableBtn</span><span class="o">.</span><span class="na">setPadding</span><span class="o">(</span><span class="k">new</span> <span class="n">Insets</span><span class="o">(</span><span class="mi">10</span><span class="o">));</span>
		<span class="n">revDisableBtn</span><span class="o">.</span><span class="na">setOnAction</span><span class="o">(</span><span class="n">e</span><span class="o">-&gt;{</span>
			<span class="c1">// CAN 데이터 수신 여부 설정</span>
			<span class="c1">// 시작문자 =&gt; 1문자 =&gt; ":" 이용</span>
			<span class="c1">// 명령코드 =&gt; 1문자 =&gt; "G"</span>
			<span class="c1">// 수신 여부 명령 코드 =&gt; 2문자</span>
			<span class="c1">//                   00 : 현재 CANPro의 CAN 데이터 수신 여부 환경을 읽어온다.</span>
			<span class="c1">//                   10 : CANPro의 CAN 데이터 수신 동작을 중지한다.</span>
			<span class="c1">//                   11 : CANPro의 CAN 데이터 수신 동작을 시작한다.</span>
			<span class="c1">// Check Sum =&gt; 2문자</span>
			<span class="n">String</span> <span class="n">str</span> <span class="o">=</span> <span class="s">"G10"</span><span class="o">;</span>
			<span class="n">String</span> <span class="n">tmpStr</span> <span class="o">=</span> <span class="n">str</span><span class="o">.</span><span class="na">toUpperCase</span><span class="o">();</span>
			<span class="kt">char</span> <span class="n">c</span><span class="o">[]</span> <span class="o">=</span> <span class="n">tmpStr</span><span class="o">.</span><span class="na">toCharArray</span><span class="o">();</span>
			<span class="kt">int</span> <span class="n">checksumData</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
			<span class="k">for</span> <span class="o">(</span><span class="kt">char</span> <span class="n">cc</span> <span class="o">:</span> <span class="n">c</span><span class="o">)</span> <span class="o">{</span>
				<span class="n">checksumData</span> <span class="o">+=</span> <span class="n">cc</span><span class="o">;</span>
			<span class="o">}</span>
			<span class="n">checksumData</span> <span class="o">=</span> <span class="o">(</span><span class="n">checksumData</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="o">);</span>
			<span class="n">String</span> <span class="n">checksumHexString</span> <span class="o">=</span> <span class="n">Integer</span><span class="o">.</span><span class="na">toHexString</span><span class="o">(</span><span class="n">checksumData</span><span class="o">).</span><span class="na">toUpperCase</span><span class="o">();</span>
			<span class="c1">//printMSG("checksum계산값 : " + checksumHexString);</span>
			
			<span class="c1">// 끝문자 =&gt; 1문자 =&gt; "\r" 이용			</span>
			<span class="c1">// String msg = ":G10A9\r";</span>
			<span class="n">String</span> <span class="n">msg</span> <span class="o">=</span> <span class="s">":"</span> <span class="o">+</span> <span class="n">str</span> <span class="o">+</span> <span class="n">checksumHexString</span> <span class="o">+</span> <span class="s">"\r"</span><span class="o">;</span>
			
			<span class="k">try</span> <span class="o">{</span>
				<span class="kt">byte</span><span class="o">[]</span> <span class="n">inputData</span> <span class="o">=</span> <span class="n">msg</span><span class="o">.</span><span class="na">getBytes</span><span class="o">();</span>
				<span class="n">out</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">inputData</span><span class="o">);</span>
				<span class="c1">// 정상응답이 올경우</span>
				<span class="c1">// ":G00A7"   =&gt; 00의 의미는 현재 CAN 데이터 수신 동작이 중지.</span>
				<span class="c1">//            =&gt; 01의 의미는 현재 CAN 데이터 수신 동작이 시작.</span>
				<span class="c1">//            =&gt; A7의 의미는 G00에 대한 checksum         </span>
			<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e1</span><span class="o">)</span> <span class="o">{</span>
				<span class="n">e1</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
			<span class="o">}</span>
		<span class="o">});</span>				
		
		<span class="n">envBtn</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Button</span><span class="o">(</span><span class="s">"환경설정"</span><span class="o">);</span>
		<span class="n">envBtn</span><span class="o">.</span><span class="na">setPrefSize</span><span class="o">(</span><span class="mi">200</span><span class="o">,</span> <span class="mi">50</span><span class="o">);</span>
		<span class="n">envBtn</span><span class="o">.</span><span class="na">setPadding</span><span class="o">(</span><span class="k">new</span> <span class="n">Insets</span><span class="o">(</span><span class="mi">10</span><span class="o">));</span>
		<span class="n">envBtn</span><span class="o">.</span><span class="na">setOnAction</span><span class="o">(</span><span class="n">e</span><span class="o">-&gt;{</span>
			<span class="c1">// CAN 데이터 수신 여부 설정</span>
			<span class="c1">// 시작문자 =&gt; 1문자 =&gt; ":" 이용</span>
			<span class="c1">// 명령코드 =&gt; 1문자 =&gt; "Z"</span>
			<span class="c1">// 자세한 설정내용은 CANPro User Manual 참조</span>
			<span class="c1">// CAN bit time에 대한 내용은 User Manual 3page</span>
			<span class="c1">// 250k =&gt; 0x0F, 0x34로 지정되어 있음.</span>
			<span class="c1">// https://www.mathsisfun.com/binary-decimal-hexadecimal-converter.html</span>
			<span class="c1">// 해당사이트를 이용하면 4bit의 값을 hexa로 표현 가능.</span>
			<span class="c1">// String str = "Z 1C 0F34 00000001 00000001";</span>
			<span class="n">String</span> <span class="n">str</span> <span class="o">=</span> <span class="s">"Z1C0F340000000100000001"</span><span class="o">;</span>
			<span class="n">String</span> <span class="n">tmpStr</span> <span class="o">=</span> <span class="n">str</span><span class="o">.</span><span class="na">toUpperCase</span><span class="o">();</span>
			<span class="kt">char</span> <span class="n">c</span><span class="o">[]</span> <span class="o">=</span> <span class="n">tmpStr</span><span class="o">.</span><span class="na">toCharArray</span><span class="o">();</span>
			<span class="kt">int</span> <span class="n">checksumData</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
			<span class="k">for</span> <span class="o">(</span><span class="kt">char</span> <span class="n">cc</span> <span class="o">:</span> <span class="n">c</span><span class="o">)</span> <span class="o">{</span>
				<span class="n">checksumData</span> <span class="o">+=</span> <span class="n">cc</span><span class="o">;</span>
			<span class="o">}</span>
			<span class="n">checksumData</span> <span class="o">=</span> <span class="o">(</span><span class="n">checksumData</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="o">);</span>
			<span class="n">String</span> <span class="n">checksumHexString</span> <span class="o">=</span> <span class="n">Integer</span><span class="o">.</span><span class="na">toHexString</span><span class="o">(</span><span class="n">checksumData</span><span class="o">).</span><span class="na">toUpperCase</span><span class="o">();</span>
			<span class="c1">//printMSG("checksum계산값 : " + checksumHexString);</span>
			
			<span class="c1">// 끝문자 =&gt; 1문자 =&gt; "\r" 이용			</span>
			<span class="n">String</span> <span class="n">msg</span> <span class="o">=</span> <span class="s">":"</span> <span class="o">+</span> <span class="n">str</span> <span class="o">+</span> <span class="n">checksumHexString</span> <span class="o">+</span> <span class="s">"\r"</span><span class="o">;</span>
			
			<span class="k">try</span> <span class="o">{</span>
				<span class="kt">byte</span><span class="o">[]</span> <span class="n">inputData</span> <span class="o">=</span> <span class="n">msg</span><span class="o">.</span><span class="na">getBytes</span><span class="o">();</span>
				<span class="n">out</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">inputData</span><span class="o">);</span>
			<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e1</span><span class="o">)</span> <span class="o">{</span>
				<span class="n">e1</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
			<span class="o">}</span>
		<span class="o">});</span>				
		
		<span class="n">FlowPane</span> <span class="n">flowPane</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FlowPane</span><span class="o">();</span>
		<span class="n">flowPane</span><span class="o">.</span><span class="na">setPrefSize</span><span class="o">(</span><span class="mi">850</span><span class="o">,</span> <span class="mi">50</span><span class="o">);</span>
		<span class="n">flowPane</span><span class="o">.</span><span class="na">setHgap</span><span class="o">(</span><span class="mi">10</span><span class="o">);</span>
		<span class="n">flowPane</span><span class="o">.</span><span class="na">getChildren</span><span class="o">().</span><span class="na">add</span><span class="o">(</span><span class="n">connBtn</span><span class="o">);</span>
		<span class="n">flowPane</span><span class="o">.</span><span class="na">getChildren</span><span class="o">().</span><span class="na">add</span><span class="o">(</span><span class="n">revEnableBtn</span><span class="o">);</span>
		<span class="n">flowPane</span><span class="o">.</span><span class="na">getChildren</span><span class="o">().</span><span class="na">add</span><span class="o">(</span><span class="n">revDisableBtn</span><span class="o">);</span>
		<span class="n">flowPane</span><span class="o">.</span><span class="na">getChildren</span><span class="o">().</span><span class="na">add</span><span class="o">(</span><span class="n">envBtn</span><span class="o">);</span>
		
		<span class="n">root</span><span class="o">.</span><span class="na">setBottom</span><span class="o">(</span><span class="n">flowPane</span><span class="o">);</span>
		
		<span class="n">Scene</span> <span class="n">scene</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Scene</span><span class="o">(</span><span class="n">root</span><span class="o">);</span>
		<span class="n">primaryStage</span><span class="o">.</span><span class="na">setScene</span><span class="o">(</span><span class="n">scene</span><span class="o">);</span>
		<span class="n">primaryStage</span><span class="o">.</span><span class="na">setTitle</span><span class="o">(</span><span class="s">"CAN DataFrame Receive Test"</span><span class="o">);</span>
		<span class="n">primaryStage</span><span class="o">.</span><span class="na">setOnCloseRequest</span><span class="o">(</span><span class="n">e</span><span class="o">-&gt;{</span>
			<span class="n">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
		<span class="o">});</span>
		<span class="n">primaryStage</span><span class="o">.</span><span class="na">show</span><span class="o">();</span>
		
	<span class="o">}</span>
	 
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
		<span class="n">launch</span><span class="o">();</span>
	<span class="o">}</span>	
	
<span class="o">}</span>
</code></pre></div></div>

<p>End.</p>

<hr />

                </div>
            </section>

            <!-- Email subscribe form at the bottom of the page -->
            <!-- 기존에 있던 post하단 이메일 subscribe 삭제 -->

            <footer class="post-full-footer">
                <!-- Everything inside the #author tags pulls data from the author -->
                <!-- #author-->
                
                    
                        <section class="author-card">
                            
                                <img class="author-profile-image" src="/assets/built/images/economy-author-logo.jpg" alt="moon9342" />
                            
                            <section class="author-card-content">
                                <h4 class="author-card-name"><a href="/author/moon9342">moon9342</a></h4>
                                
                                    <p><a href="https://www.youtube.com/channel/UCp-MztINXTRVkRGCnqnYNlQ">얼큰우동TV, 쉽게배우는 IT(Programming,Machine Learning,금융)</a></p>
                                
                            </section>
                        </section>
                        <div class="post-full-footer-right">
                            <a class="author-card-button" href="/author/moon9342">Read More</a>
                        </div>
                    
                
                <!-- /author  -->
            </footer>

            <!-- If you use Disqus comments, just uncomment this block.
            The only thing you need to change is "test-apkdzgmqhj" - which
            should be replaced with your own Disqus site-id. -->
            

        </article>

    </div>
</main>

<!-- Links to Previous/Next posts -->
<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">
            
                
                
                
                
                    <article class="read-next-card"
                        
                            style="background-image: url(/assets/built/images/blog-cover2.png)"
                        
                    >
                        <header class="read-next-card-header">
                            <small class="read-next-card-header-sitetitle">&mdash; IT Technical Training &mdash;</small>
                            
                                <h3 class="read-next-card-header-title"><a href="/tag/et-cetera/">Et-cetera</a></h3>
                            
                        </header>
                        <div class="read-next-divider"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 14.5s2 3 5 3 5.5-2.463 5.5-5.5S21 6.5 18 6.5c-5 0-7 11-12 11C2.962 17.5.5 15.037.5 12S3 6.5 6 6.5s4.5 3.5 4.5 3.5"/></svg>
</div>
                        <div class="read-next-card-content">
                            <ul>
                                
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/arduino">Arduino</a></li>
                                        
                                    
                                  
                                
                                  
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/hadoop">Hadoop 설치와 활용</a></li>
                                        
                                    
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/gulp-css-compile">Gulp CSS Compile 문제 해결</a></li>
                                        
                                    
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                            </ul>
                        </div>
                        <footer class="read-next-card-footer">
                            <a href="/tag/et-cetera/">
                                
                                    See all 18 posts  →
                                
                            </a>
                        </footer>
                    </article>
                
            

            <!-- If there's a next post, display it using the same markup included from - partials/post-card.hbs -->
            
                
    <article class="post-card post-template">
        
            <a class="post-card-image-link" href="/arduino">
                <div class="post-card-image" style="background-image: url(/assets/built/images/iot-logo.png)"></div>
            </a>
        
        <div class="post-card-content">
            <a class="post-card-content-link" href="/arduino">
                <header class="post-card-header">
                    
                        
                            
                                <span class="post-card-tags">Et-cetera</span>
                            
                        
                    

                    <h2 class="post-card-title">Arduino</h2>
                </header>
                <section class="post-card-excerpt">
                    <p>**{% include subtitle-fontawesome.html %} Arduino 개요** `아두이노(Arduino)`는 이탈리아에서 개발한 오픈소스 보드로 이탈리아어로 `강한 친구`라는 뜻을 가지고 있습니다. >아두이노는 우리가 흔히 얘기하는 컴퓨터가 아닙니다. `라즈베리파이`와는 다르게 아두이노는 우리가 사용하는 컴퓨터처럼 OS를 설치하고 응용프로그램을 설치하는</p>
                </section>
            </a>
            <footer class="post-card-meta">
                
                    
                        
                        <img class="author-profile-image" src="/assets/built/images/economy-author-logo.jpg" alt="moon9342" />
                        
                        <span class="post-card-author">
                            <a href="/author/moon9342/">moon9342</a>
                        </span>
                    
                
            </footer>
        </div>
    </article>

            

            <!-- If there's a previous post, display it using the same markup included from - partials/post-card.hbs -->
            
                
    <article class="post-card post-template">
        
            <a class="post-card-image-link" href="/hadoop">
                <div class="post-card-image" style="background-image: url(/assets/built/images/iot-logo.png)"></div>
            </a>
        
        <div class="post-card-content">
            <a class="post-card-content-link" href="/hadoop">
                <header class="post-card-header">
                    
                        
                            
                                <span class="post-card-tags">Et-cetera</span>
                            
                        
                    

                    <h2 class="post-card-title">Hadoop 설치와 활용</h2>
                </header>
                <section class="post-card-excerpt">
                    <p>VMware Workstation Pro 15 설치 및 CentOS 7 설치 Hadoop을 사용하기 위해서 Windows 10에 VMWARE Workstation Pro 15를 설치한 후 CentOS 7을 설치합니다. (VMWare Workstation Player는 무료로 사용가능하지만 Workstation Pro 버전은 유료입니다. 30일</p>
                </section>
            </a>
            <footer class="post-card-meta">
                
                    
                        
                        <img class="author-profile-image" src="/assets/built/images/economy-author-logo.jpg" alt="moon9342" />
                        
                        <span class="post-card-author">
                            <a href="/author/moon9342/">moon9342</a>
                        </span>
                    
                
            </footer>
        </div>
    </article>

            

        </div>
    </div>
</aside>

<!-- Floating header which appears on-scroll, included from includes/floating-header.hbs -->
<div class="floating-header">
    <div class="floating-header-logo">
        <a href="http://localhost:4000/">
            
            <span>IT Technical Training</span>
        </a>
    </div>
    <span class="floating-header-divider">&mdash;</span>
    <div class="floating-header-title">CAN Protocol</div>



    <div class="floating-header-share">
        <div class="floating-header-share-label">이 포스트를 공유하세요 <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
    <path d="M7.5 15.5V4a1.5 1.5 0 1 1 3 0v4.5h2a1 1 0 0 1 1 1h2a1 1 0 0 1 1 1H18a1.5 1.5 0 0 1 1.5 1.5v3.099c0 .929-.13 1.854-.385 2.748L17.5 23.5h-9c-1.5-2-5.417-8.673-5.417-8.673a1.2 1.2 0 0 1 1.76-1.605L7.5 15.5zm6-6v2m-3-3.5v3.5m6-1v2"/>
</svg>
</div>
        <a class="floating-header-share-tw" href="https://twitter.com/share?text=CAN+Protocol&amp;url=https://moon9342.github.io/can"
            onclick="window.open(this.href, 'share-twitter', 'width=550,height=235');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg>

        </a>
        <a class="floating-header-share-fb" href="https://www.facebook.com/sharer/sharer.php?u=https://moon9342.github.io/can"
            onclick="window.open(this.href, 'share-facebook','width=580,height=296');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"/></svg>

        </a>
    </div>


    <!-- floating-header에 이미지 삽입 -->
<!--
    <div class="floating-header-share">
        <img src="assets/images/photo.jpg" width="50">
    </div>
-->

    <progress class="progress" value="0">
        <div class="progress-container">
            <span class="progress-bar"></span>
        </div>
    </progress>
</div>


<!-- /post -->

<!-- The #contentFor helper here will send everything inside it up to the matching #block helper found in default.hbs -->

        <!-- Previous/next page links - displayed on every page -->
        

        <!-- The footer at the very bottom of the screen -->
        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="http://localhost:4000/">IT Technical Training</a> &copy; 2021</section>
                <section class="poweredby">Proudly published with <a href="https://jekyllrb.com/">Jekyll</a> &
                    <a href="https://pages.github.com/">GitHub Pages</a></section>
                <nav class="site-footer-nav">
                    <a href="mailto:moon9342@gmail.com">moon9342@gmail.com</a>
                    <a href="/">Latest Posts</a>
                    
                    
                </nav>
            </div>
        </footer>

    </div>

    <!-- The big email subscribe modal content -->
    
        <div id="subscribe" class="subscribe-overlay">
            <a class="subscribe-overlay-close" href="#"></a>
            <div class="subscribe-overlay-content">
                
                <h1 class="subscribe-overlay-title">Search IT Technical Training</h1>
                <p class="subscribe-overlay-description">lunr.js를 이용한 posts 검색 </p>
                <span id="searchform" method="post" action="/subscribe/" class="">
    <input class="confirm" type="hidden" name="confirm"  /><input class="location" type="hidden" name="location"  /><input class="referrer" type="hidden" name="referrer"  />

    <div class="form-group">
        <input class="subscribe-email" onkeyup="myFunc()" id="searchtext" type="text" name="searchtext"  placeholder="Search..." />
    </div>
    <!--<button class="" onclick="myFunc()" id="searchBtn" type="button" ><span>Search</span></button>-->
    <script type="text/javascript">
        function myFunc() {
            if(event.keyCode == 13) {
                var url = encodeURIComponent($("#searchtext").val());
                location.href = "/search.html?query=" + url;
            }
        }
    </script>
    <!--<script type="text/et-cetera">(function(g,h,o,s,t){h[o]('.location')[s]=h[o]('.location')[s] || g.location.href;h[o]('.referrer')[s]=h[o]('.referrer')[s] || h.referrer;})(window,document,'querySelector','value');</script>-->
</span>


            </div>
        </div>
    

    <!-- highlight.js -->
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    <script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>


    <!-- Paginator increased to "infinit" in _config.yml -->
    <!-- if paginator.posts  -->
    <!-- <script>
        var maxPages = parseInt('');
    </script>
    <script src="/assets/js/infinitescroll.js"></script> -->
    <!-- /endif -->

    


    <!-- Add Google Analytics  -->
    <!-- Google Analytics Tracking code -->
 <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-113135179-1', 'auto');
  ga('send', 'pageview');

 </script>


    <!-- The #block helper will pull in data from the #contentFor other template files. In this case, there's some JavaScript which we only want to use in post.hbs, but it needs to be included down here, after jQuery has already loaded. -->
    
        <script>

// NOTE: Scroll performance is poor in Safari
// - this appears to be due to the events firing much more slowly in Safari.
//   Dropping the scroll event and using only a raf loop results in smoother
//   scrolling but continuous processing even when not scrolling
$(document).ready(function () {
    // Start fitVids
    var $postContent = $(".post-full-content");
    $postContent.fitVids();
    // End fitVids

    var progressBar = document.querySelector('progress');
    var header = document.querySelector('.floating-header');
    var title = document.querySelector('.post-full-title');

    var lastScrollY = window.scrollY;
    var lastWindowHeight = window.innerHeight;
    var lastDocumentHeight = $(document).height();
    var ticking = false;

    function onScroll() {
        lastScrollY = window.scrollY;
        requestTick();
    }

    function onResize() {
        lastWindowHeight = window.innerHeight;
        lastDocumentHeight = $(document).height();
        requestTick();
    }

    function requestTick() {
        if (!ticking) {
            requestAnimationFrame(update);
        }
        ticking = true;
    }

    function update() {
        var trigger = title.getBoundingClientRect().top + window.scrollY;
        var triggerOffset = title.offsetHeight + 35;
        var progressMax = lastDocumentHeight - lastWindowHeight;

        // show/hide floating header
        if (lastScrollY >= trigger + triggerOffset) {
            header.classList.add('floating-active');
        } else {
            header.classList.remove('floating-active');
        }

        progressBar.setAttribute('max', progressMax);
        progressBar.setAttribute('value', lastScrollY);

        ticking = false;
    }

    window.addEventListener('scroll', onScroll, {passive: true});
    window.addEventListener('resize', onResize, false);

    update();
});
</script>

    

    <!-- Ghost outputs important scripts and data with this tag - it should always be the very last thing before the closing body tag -->
    <!-- ghost_foot -->

</body>
</html>
